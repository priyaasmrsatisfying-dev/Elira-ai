const sendBtn = document.getElementById("sendBtn");
const input = document.getElementById("userInput");
const chatArea = document.getElementById("chatArea");

sendBtn.addEventListener("click", sendMessage);
input.addEventListener("keypress", function (e) {
  if (e.key === "Enter") sendMessage();
});

function sendMessage() {
  const userText = input.value.trim();
  if (userText === "") return;

  // USER MESSAGE
  const userMsg = document.createElement("div");
  userMsg.className = "message user";
  userMsg.innerText = userText;
  chatArea.appendChild(userMsg);

  input.value = "";
  chatArea.scrollTop = chatArea.scrollHeight;

  // Calm pause before Elira replies
  setTimeout(() => {
    const eliraMsg = document.createElement("div");
    eliraMsg.className = "message elira";
    eliraMsg.innerText = getEliraReply(userText);
    chatArea.appendChild(eliraMsg);
    chatArea.scrollTop = chatArea.scrollHeight;
  }, 900);
}

/* ğŸŒ LANGUAGE + EMOTION AWARE ELIRA */
function getEliraReply(text) {
  const lower = text.toLowerCase();

  // --- LANGUAGE DETECTION (basic demo) ---
  const isHindi = /hai|nahi|kyu|kya|thik|haan|dukhi|akela/.test(lower);
  const isMarathi = /ahe|kaay|nahi|bara|dukhi/.test(lower);
  const isUrdu = /hai|nahi|kyun|akela|udaas/.test(lower);

  // --- EMOTIONAL STATES ---
  const sadWords = ["sad", "tired", "alone", "cry", "hurt", "dukhi", "udaas", "akela"];
  const angryWords = ["angry", "frustrated", "fed up", "gussa", "pareshan"];
  const happyWords = ["happy", "good", "excited", "khush", "accha"];

  if (sadWords.some(word => lower.includes(word))) {
    if (isHindi || isUrdu)
      return "Yeh thoda bhaari lag raha haiâ€¦ main yahin hoon. Jaldi karne ki zarurat nahi ğŸ¤";
    if (isMarathi)
      return "He thoda jà¤¡ à¤µà¤¾à¤Ÿà¤¤à¤‚à¤¯â€¦ mi ikà¤¡à¥‡ aahe. Ghaya nako ğŸ¤";
    return "That sounds heavyâ€¦ Iâ€™m here with you. You donâ€™t have to rush ğŸ¤";
  }

  if (angryWords.some(word => lower.includes(word))) {
    if (isHindi || isUrdu)
      return "Aisa mehsoos hona theek hai. Chaaho toh bol sakti ho, main sun rahi hoon.";
    if (isMarathi)
      return "Asa à¤µà¤¾à¤Ÿà¤£à¤‚ theek aahe. Mi aiktey.";
    return "Itâ€™s okay to feel this way. Iâ€™m listening.";
  }

  if (happyWords.some(word => lower.includes(word))) {
    if (isHindi || isUrdu)
      return "Yeh sunke accha laga ğŸ˜Š";
    if (isMarathi)
      return "He aikun chhaan à¤µà¤¾à¤Ÿà¤²à¤‚ ğŸ˜Š";
    return "Thatâ€™s nice to hear ğŸ˜Š";
  }

  // --- DEFAULT CALM RESPONSES ---
  const softReplies = [
    "Iâ€™m here. Take your time ğŸŒ™",
    "You donâ€™t have to explain everything.",
    "We can talkâ€¦ or just sit quietly.",
    "Youâ€™re safe here.",
    "Iâ€™m listening ğŸ¤"
  ];

  return softReplies[Math.floor(Math.random() * softReplies.length)];
}
